<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    {% load staticfiles %}

    <script type="text/javascript" src="{% static 'CryptoJS_v3.1.2\rollups\aes.js' %}"></script>

    <script type="text/javascript" src="{% static 'CryptoJS_v3.1.2\components\core.js' %}"></script>
    <script type="text/javascript" src="{% static 'CryptoJS_v3.1.2\components\enc-base64.js' %}"></script>
    <script type="text/javascript" src="{% static 'CryptoJS_v3.1.2\components\enc-utf16.js' %}"></script>

    <script type="text/javascript" src="{% static 'CryptoJS_v3.1.2\components\mode-cfb.js' %}"></script>
    <script type="text/javascript" src="{% static 'CryptoJS_v3.1.2\components\mode-ctr.js' %}"></script>

    <script type="text/javascript" src="{% static 'CryptoJS_v3.1.2\components\pad-iso97971.js' %}"></script>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

    <script type="text/javascript" src="{% static 'decryptfiles.js' %}">
    $('#in_file').on('change', function() {
    decryptfile();})
    </script>

    <script>function download(filename, text) {
  var element = document.createElement('a');
  element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
  element.setAttribute('download', filename);
  document.body.appendChild(element);
  element.click();

  document.body.removeChild(element);
}</script>

</head>
<link rel='stylesheet' href="/static/css/base.css"/>
<body>

<div id="mainbody">

    <div id="title"><h1>Decrypt Your Files</h1></div>
    <div id="welcome">
    <ul>   <h3> Welcome {{ user.username }} </h3> </ul>
        <a href="/users" class="button">Home</a>
        <a href="/users/encrypt/" class="button">Encrypt text</a>
        <a href="/users/decrypt/" class="button">Decrypt text</a>
        <a href="/users/messages" class="button">Store Messages</a>
        <a href="/users/instructions" class="button">Guide page</a>
        <a href="/accounts/logout/" class="button">Signout</a></div>

    <div id="decryptfile">
<form onsubmit="download(this['name'].value, this['text'].value)">
            <label for="id_password">Password: </label><input id="id_password" type="text" required><br>
    <br><label for="in_file">Input file: </label><input type="file" id="in_file" onchange="decryptfile()"></input>

            <input type="text" id="name" name="name" hidden><br>
            <textarea id="text" name="text" hidden></textarea><br>

  <input type="submit" value="Download"><br><br>

</form>
    </div></div>

</body>
</html>